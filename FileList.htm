<!DOCTYPE html>
<html lang="ru">
<script src="./scripts/jquery.min.js"></script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="title">file list</title>
</head>

<body>
    <div id="table"></div>
</body>
<style>
    @font-face {
        font-family: clacon2;
        src: url('./fonts/clacon2.woff2') format("woff2"),
            url('./fonts/clacon2.ttf') format('truetype');
        font-weight: normal;
        font-style: normal;
    }

    :root {
        cursor: url('./cursor.png'), auto;

        font-family: "clacon2", "Arial", sans-serif;
        background-color: #000075;
        color: #6fcbcb;
        user-select: none;
    }



    /* body {

    } */

    #table {
        display: flex;
        flex-wrap: nowrap;
        flex-direction: row;
    }

    .list {
        display: flex;
        flex-direction: column;
        flex-wrap: nowrap;
        align-items: stretch;
        width: 128px;
        border: solid;
    }

    .button {
        /* display: table; */
        padding: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;

    }

    .button:hover {
        color: #00076b;
        background-color: #009797;
    }

    .directory {
        color: #b9cdcd;
    }
</style>
<script>
    console.log("jquery", $.fn.jquery)
    var database = {}
    var line = null
    var column = 0
    var adres = []

    function sort1(o1, o2) {
        return o1.type.localeCompare(o2.type)
    }

    $.get('./DataList.json', function (data) {
        database = data.children
        database.sort(sort1)
        select_button(database)
        console.log(database)
    });

    function select_button(database) {
        remove_button()
        database.forEach(function (e, i, a) {
            add_button(e, i, a)
        });
    }
    function remove_button(e, i, a) {
        $("#table").empty();
        line = null
        column = 0
    }
    function back_button() {
        dat = {}
        adres.pop()
        if (adres.length > 0) {
            adres.forEach(e => {
                dat = database[e].children.sort(sort1)
            });
            // if(dat == {}) dat = database
            console.log(dat, database)
            select_button(dat)
        } else {
            console.log(dat, database)
            select_button(database)
        }
    }

    function add_button(e, i, a) {
        if (line == 0 || line == null) $('#table').append(`<div id="list${column}"class="list"></div>`)
        if (line == null) {
            $('#list' + column).append(`<div id='button' class='button'>..</div>`)
            $(`#button`).on("click", function () { back_button() })
        }
        if (line < 20) {
            line++
        } else {
            line = 0
            column++
        }
        $('#list' + column).append(`<div id='button${i}' class='button ${e.type}'>${e.name}</div>`)
        if (e.type == "file") {

        } else {
            $(`#button${i}`).on("click", function () {
                adres.push(i)
                select_button(a[i].children.sort(sort1))
                console.log(adres)
            })
        }
        $(`#button${i}`).on("click", function () {
            console.log(e.type, a[i])
        })

    }
</script>

</html>